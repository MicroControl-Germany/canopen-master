<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-62K6JPR1V6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-62K6JPR1V6');
</script>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CANopen Master Protocol Stack | Add-on Safety</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
   DoxygenAwesomeDarkModeToggle.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mc-awesome.css" rel="stylesheet" type="text/css"/>
<link href="mc-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="mc-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">CANopen Master Documentation</div>
   <div id="projectnumber">Version 6.08.00</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('com_add_on_safety.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Add-on Safety</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2Users_2koppe_2Projekte_2CANopen-FD-Master_2source_2stack-com_2safety_2README"></a> The add-on module <a class="el" href="com_add_on_safety.html">Safety</a> allows the integration of the SRDO service as specified in <a class="el" href="com_references.html#en50325-5">EN 50525-5</a>.</p>
<p>CANopen defines communication profiles based on ISO 11898-1. The basic profiles are defined in EN 50325-4. The SRCP (Safety-related communication profile and protocols, i.e. CANopen Safety) is based on the basic profiles in EN 50325-4 and the SCL (Safety Communication Layer, EN 61784â€“3) specification.</p>
<p>The SRCP is based on the producer/consumer model. The pairing of producers and consumers is an important part of the relationship that provides the high integrity needed for SRLD (Safety-related logical device). The SCL is specified using SR (Safety-related) data objects (SRDOs). These objects are serving as the interface between the SR application objects and the link layer connections. An SRDO ensures the integrity of the safety data transfers.</p>
<h1>Module version</h1>
<p>The <a class="el" href="group__COM__SAFETY__VERSION.html">module version</a> is defined by <a class="el" href="group__COM__SAFETY__VERSION.html#ga0b5303af56c7169c3e5a331161136d7e">COM_SAFETY_VERSION_MAJOR</a> and <a class="el" href="group__COM__SAFETY__VERSION.html#ga627a9adc55ce66a8fb91e6dd83e9fdfd">COM_SAFETY_VERSION_MINOR</a>.</p>
<h1>Configuration</h1>
<p>The module is configured by setting of the following symbols inside the <code><a class="el" href="com__conf_8h.html" title="CANopen Master stack configuration .">com_conf.h</a></code> file:</p>
<div class="function" style="width:800px"> <table class="function" style="width:800px">
<tr>
<td class="entry" style="width:25%"><a class="el" href="com__conf_8h.html#a2c5d5de0657851f2e471620a27cad454">COM_SRDO_NUMBER</a> </td><td class="desc"><p class="starttd">number of supported SRDOs </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td class="entry" style="width:25%"><a class="el" href="com__conf_8h.html#a214852cf301747444347467b505c47ac">COM_SRDO_TRM_FIFO_SIZE</a> </td><td class="desc"><p class="starttd">FIFO size for transmission of SRDOs </p>
<p class="endtd"></p>
</td></tr>
</table>
</div><h1>Interface to application</h1>
<p>Use the header file <code><a class="el" href="com__safety_8h.html" title="CANopen Master Functional Safety .">com_safety.h</a></code> to get access to the <a class="el" href="com_add_on_safety.html">Add-on Safety</a> API.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="com__safety_8h.html">com_safety.h</a>&quot;</span></div>
<div class="ttc" id="acom__safety_8h_html"><div class="ttname"><a href="com__safety_8h.html">com_safety.h</a></div><div class="ttdoc">CANopen Master Functional Safety .</div></div>
</div><!-- fragment --><h2>Configuration Example</h2>
<p>In order to configure the objects of a SR device the following commands have to be executed:</p>
<ul>
<li>Initialize a SRDO data structure</li>
<li>Read the actual SRDO data structure of the SR device</li>
<li>Modify SRDO data structure (optional)</li>
<li>Write modified SRDO data structure to SR device (optional)</li>
<li>Calculate the CRC signature of the SRDO data structure</li>
<li>Write CRC signature to SR device</li>
<li>Write configuration valid to SR device</li>
</ul>
<p>Please note that all these steps have to be executed in Pre-Operational state of the SR device. All functions which access the object dictionary of the SR device via SDO (e.g. <a class="el" href="com__safety_8h.html#ace1c76b320fa9d047799f72868bba831">ComSafetyGetConfiguration()</a>, etc.) are non-blocking, hence the application has to wait until the SDO data transfer has finished before the next command can be executed. This can be achieved either by implementation of an application specific FSA using the <a class="el" href="com__object_8h.html#a4dd28ba744c2946eeb804421ee3f49ba">ComObjectEventReady()</a> event or by polling the status value of <a class="el" href="com__safety_8h.html#afb40c740c6c6e6e27bfa3775601b1ae8">ComSafetyGetSdoStatus()</a>.</p>
<p>The following code example depicts the configuration procedure.</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structComSrdo__s.html">ComSrdo_ts</a>    tsSrdoS;      <span class="comment">// SRDO data structure</span></div>
<div class="line">uint16_t             uwSignatureT; <span class="comment">// SRDO CRC signature</span></div>
<div class="line"><span class="keyword">enum</span> <a class="code hl_enumeration" href="com__sdo__cln_8h.html#aead62a38243d8f4310c8451fde92b2ae">ComSdoStat_e</a>    teStatusT;    <span class="comment">// SDO communication status</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Initialize the SRDO data structure:</span></div>
<div class="line"><span class="comment">// SR device has node-ID 3, setup SRDO number 1</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><a class="code hl_function" href="com__safety_8h.html#aeefadfc3457f3213c52575a99a27db59">ComSafetySrdoInit</a>(<a class="code hl_enumvalue" href="com__defs_8h.html#a9fcbaaae42ba2be384e65200b4eb98beaf76f82dfac87612621bd4bb5a7585d8a">eCOM_NET_1</a>, 3, 1, &amp;tsSrdoS);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Read the actual SRDO data structure:</span></div>
<div class="line"><span class="comment">// SR device has node-ID 3, setup SRDO number 1</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><a class="code hl_function" href="com__safety_8h.html#ace1c76b320fa9d047799f72868bba831">ComSafetyGetConfiguration</a>(<a class="code hl_enumvalue" href="com__defs_8h.html#a9fcbaaae42ba2be384e65200b4eb98beaf76f82dfac87612621bd4bb5a7585d8a">eCOM_NET_1</a>, 3, 1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Wait until the SDO data transfer is completed</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordflow">do</span> {</div>
<div class="line">      <a class="code hl_function" href="com__safety_8h.html#afb40c740c6c6e6e27bfa3775601b1ae8">ComSafetyGetSdoStatus</a>(<a class="code hl_enumvalue" href="com__defs_8h.html#a9fcbaaae42ba2be384e65200b4eb98beaf76f82dfac87612621bd4bb5a7585d8a">eCOM_NET_1</a>, 3, 1, &amp;teStatusT);</div>
<div class="line">} <span class="keywordflow">while</span> (teStatusT &lt; <a class="code hl_enumvalue" href="com__sdo__cln_8h.html#aead62a38243d8f4310c8451fde92b2aea1be852584fe9771e2a6479adcd4c370e">eCOM_SDO_STAT_SUCCESS</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Now the SRDO data structure &#39;tsSrdoS&#39; holds the data of</span></div>
<div class="line"><span class="comment">// the SR device: Calculate the CRC signature of SRDO</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line">uwSignatureT = <a class="code hl_function" href="com__safety_8h.html#a021b94490cc858200f2bbb2661b691fd">ComSafetyGetCrcValue</a>(&amp;tsSrdoS);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Write CRC signature to SR device</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><a class="code hl_function" href="com__safety_8h.html#aafdf37c08f8382b60434ef667731e0ac">ComSafetySetSignature</a>(<a class="code hl_enumvalue" href="com__defs_8h.html#a9fcbaaae42ba2be384e65200b4eb98beaf76f82dfac87612621bd4bb5a7585d8a">eCOM_NET_1</a>, 3, 1, uwSignatureT);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Wait until the SDO data transfer is completed</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordflow">do</span> {</div>
<div class="line">    <a class="code hl_function" href="com__safety_8h.html#afb40c740c6c6e6e27bfa3775601b1ae8">ComSafetyGetSdoStatus</a>(<a class="code hl_enumvalue" href="com__defs_8h.html#a9fcbaaae42ba2be384e65200b4eb98beaf76f82dfac87612621bd4bb5a7585d8a">eCOM_NET_1</a>, 3, 1, &amp;teStatusT);</div>
<div class="line">} <span class="keywordflow">while</span> (teStatusT &lt; <a class="code hl_enumvalue" href="com__sdo__cln_8h.html#aead62a38243d8f4310c8451fde92b2aea1be852584fe9771e2a6479adcd4c370e">eCOM_SDO_STAT_SUCCESS</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Write configuration valid to SR device</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><a class="code hl_function" href="com__safety_8h.html#a56f61848829e0bd28559599a19c6cc43">ComSafetySetConfigurationValid</a>(<a class="code hl_enumvalue" href="com__defs_8h.html#a9fcbaaae42ba2be384e65200b4eb98beaf76f82dfac87612621bd4bb5a7585d8a">eCOM_NET_1</a>, 3);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Wait until the SDO data transfer is completed</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordflow">do</span> {</div>
<div class="line">      <a class="code hl_function" href="com__safety_8h.html#afb40c740c6c6e6e27bfa3775601b1ae8">ComSafetyGetSdoStatus</a>(<a class="code hl_enumvalue" href="com__defs_8h.html#a9fcbaaae42ba2be384e65200b4eb98beaf76f82dfac87612621bd4bb5a7585d8a">eCOM_NET_1</a>, 3, 1, &amp;teStatusT);</div>
<div class="line">} <span class="keywordflow">while</span> (teStatusT &lt; <a class="code hl_enumvalue" href="com__sdo__cln_8h.html#aead62a38243d8f4310c8451fde92b2aea1be852584fe9771e2a6479adcd4c370e">eCOM_SDO_STAT_SUCCESS</a>);</div>
<div class="ttc" id="acom__defs_8h_html_a9fcbaaae42ba2be384e65200b4eb98beaf76f82dfac87612621bd4bb5a7585d8a"><div class="ttname"><a href="com__defs_8h.html#a9fcbaaae42ba2be384e65200b4eb98beaf76f82dfac87612621bd4bb5a7585d8a">eCOM_NET_1</a></div><div class="ttdeci">@ eCOM_NET_1</div><div class="ttdef"><b>Definition</b> com_defs.h:728</div></div>
<div class="ttc" id="acom__safety_8h_html_a021b94490cc858200f2bbb2661b691fd"><div class="ttname"><a href="com__safety_8h.html#a021b94490cc858200f2bbb2661b691fd">ComSafetyGetCrcValue</a></div><div class="ttdeci">uint16_t ComSafetyGetCrcValue(ComSrdo_ts *ptsSrdoV)</div></div>
<div class="ttc" id="acom__safety_8h_html_a56f61848829e0bd28559599a19c6cc43"><div class="ttname"><a href="com__safety_8h.html#a56f61848829e0bd28559599a19c6cc43">ComSafetySetConfigurationValid</a></div><div class="ttdeci">ComStatus_tv ComSafetySetConfigurationValid(uint8_t ubNetV, uint8_t ubNodeIdV)</div></div>
<div class="ttc" id="acom__safety_8h_html_aafdf37c08f8382b60434ef667731e0ac"><div class="ttname"><a href="com__safety_8h.html#aafdf37c08f8382b60434ef667731e0ac">ComSafetySetSignature</a></div><div class="ttdeci">ComStatus_tv ComSafetySetSignature(uint8_t ubNetV, uint8_t ubNodeIdV, uint8_t ubSrdoNumberV, uint16_t uwSignatureV)</div></div>
<div class="ttc" id="acom__safety_8h_html_ace1c76b320fa9d047799f72868bba831"><div class="ttname"><a href="com__safety_8h.html#ace1c76b320fa9d047799f72868bba831">ComSafetyGetConfiguration</a></div><div class="ttdeci">ComStatus_tv ComSafetyGetConfiguration(uint8_t ubNetV, uint8_t ubNodeIdV, uint8_t ubSrdoNumberV)</div></div>
<div class="ttc" id="acom__safety_8h_html_aeefadfc3457f3213c52575a99a27db59"><div class="ttname"><a href="com__safety_8h.html#aeefadfc3457f3213c52575a99a27db59">ComSafetySrdoInit</a></div><div class="ttdeci">ComStatus_tv ComSafetySrdoInit(uint8_t ubNetV, uint8_t ubNodeIdV, uint8_t ubSrdoNumberV, ComSrdo_ts *ptsSrdoV)</div></div>
<div class="ttc" id="acom__safety_8h_html_afb40c740c6c6e6e27bfa3775601b1ae8"><div class="ttname"><a href="com__safety_8h.html#afb40c740c6c6e6e27bfa3775601b1ae8">ComSafetyGetSdoStatus</a></div><div class="ttdeci">ComStatus_tv ComSafetyGetSdoStatus(uint8_t ubNetV, uint8_t ubNodeIdV, uint8_t ubSrdoNumberV, enum ComSdoStat_e *pteStatusV)</div></div>
<div class="ttc" id="acom__sdo__cln_8h_html_aead62a38243d8f4310c8451fde92b2ae"><div class="ttname"><a href="com__sdo__cln_8h.html#aead62a38243d8f4310c8451fde92b2ae">ComSdoStat_e</a></div><div class="ttdeci">ComSdoStat_e</div><div class="ttdoc">SDO transfer status.</div><div class="ttdef"><b>Definition</b> com_sdo_cln.h:77</div></div>
<div class="ttc" id="acom__sdo__cln_8h_html_aead62a38243d8f4310c8451fde92b2aea1be852584fe9771e2a6479adcd4c370e"><div class="ttname"><a href="com__sdo__cln_8h.html#aead62a38243d8f4310c8451fde92b2aea1be852584fe9771e2a6479adcd4c370e">eCOM_SDO_STAT_SUCCESS</a></div><div class="ttdeci">@ eCOM_SDO_STAT_SUCCESS</div><div class="ttdef"><b>Definition</b> com_sdo_cln.h:100</div></div>
<div class="ttc" id="astructComSrdo__s_html"><div class="ttname"><a href="structComSrdo__s.html">ComSrdo_s</a></div><div class="ttdoc">SRDO structure.</div><div class="ttdef"><b>Definition</b> com_safety.h:189</div></div>
</div><!-- fragment --><h1>CANopen Safety files</h1>
<div class="function" style="width:800px"> <table class="function" style="width:800px">
<tr class="odd">
<td class="entry" style="width:25%"><a class="el" href="com__safety_8h.html#COM_SAFETY">com_safety.h</a> </td><td class="desc"><p class="starttd">CANopen Safety add-on module </p>
<p class="endtd"></p>
</td></tr>
</table>
</div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer"><a href="https://www.microcontrol.net">&copy; MicroControl GmbH &amp; Co. KG</a> Wed Apr 23 2025 </li>
  </ul>
</div>
</body>
</html>
